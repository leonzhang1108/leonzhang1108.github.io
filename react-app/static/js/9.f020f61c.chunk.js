webpackJsonp([9,34],{1510:function(t,e,n){"use strict";var o=n(0),r=(n.n(o),n(1511)),i=(n.n(r),n(1513)),s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clicked=!1,e.isSVGDragging=!1,e.lastMouseX=null,e.lastMouseY=null,e.movedX=null,e.movedY=null,e.initCanvas=function(){e.img=new Image;var t=e.props.src;e.img.src=t,e.img.onload=function(){e.canvas=document.querySelector(".picture-scrutinizer"),e.ctx=e.canvas.getContext("2d");var t=e.props,n=t.wrapperWidth,o=t.wrapperHeight;e.canvas.width=n,e.canvas.height=o,e.draw(),e.setEvents()}},e.zoom=function(t){var n=Math.pow(1.1,t),o=e.state,r=o.times,i=o.currentTimes;e.setState({times:r*n,currentTimes:i*n},e.draw)},e.setEvents=function(){e.wrapper.addEventListener("wheel",e.onMouseWheel,{passive:!1}),e.wrapper.addEventListener("mousedown",e.onMouseDown),e.wrapper.addEventListener("mousemove",e.onMouseMove),document.addEventListener("mouseup",e.onMouseUp)},e.removeEvents=function(){e.wrapper.removeEventListener("wheel",e.onMouseWheel),e.wrapper.removeEventListener("mousedown",e.onMouseDown),e.wrapper.removeEventListener("mousemove",e.onMouseMove),document.removeEventListener("mouseup",e.onMouseUp)},e.onMouseWheel=function(t){e.lastMouseX&&e.lastMouseY&&e.zoom(t.wheelDelta/300),t.preventDefault()},e.onMouseDown=function(t){var n=t.offsetX,o=t.offsetY;e.clicked=!0,e.movedX=n,e.movedY=o,e.resetTopLeft()},e.onMouseMove=function(t){var n=t.offsetX,o=t.offsetY,r=e.state.currentTimes;e.lastMouseX=n,e.lastMouseY=o,1!==r&&e.setState({currentTimes:1}),e.clicked?e.drag(t):e.resetTopLeft()},e.onMouseUp=function(){e.clicked=!1,e.movedX=null,e.movedY=null,e.isSVGDragging=!1,e.resetTopLeft()},e.resetTopLeft=function(){var t=e.state,n=t.left,o=t.top,r=t.lastX,i=t.lastY;r===n&&i===o||e.setState({left:r,top:i})},e.drag=function(t){if(["circle","line","polygon"].indexOf(t.target.tagName)>=0||e.isSVGDragging)e.isSVGDragging=!0;else{var n=t.offsetX,o=t.offsetY,r=e.state,i=r.top,s=r.left+n-(e.movedX||0),a=i+o-(e.movedY||0);e.draw(s,a)}},e.draw=function(t,n){var o=e.props,r=o.wrapperWidth,i=o.wrapperHeight,s=e.state,a=s.top,u=s.left,p=s.currentTimes,c=s.times,l=e.calculate(e.img,e.props),f=l.width,d=l.height;void 0!==t&&void 0!==n||(null!==a&&null!==u?(t=u||0,n=a||0):(t=(r-f)/2,n=(i-d)/2)),t+=((e.lastMouseX||0)-t)*(1-p),n+=((e.lastMouseY||0)-n)*(1-p),e.setState({lastX:t,lastY:n}),e.ctx.clearRect(0,0,r,i),e.ctx.drawImage(e.img,t,n,f*c,d*c)},e.calculate=function(t,e){var n=t.height,o=t.width,r=e.wrapperHeight,i=e.wrapperWidth,s=n/o,a={height:0,width:0};return n/o-r/i>0?(a.height=r,a.width=a.height/s):(a.width=i,a.height=a.width*s),a},e}return s(e,t),e.prototype.componentWillMount=function(){this.setState({times:1,currentTimes:1,top:null,left:null,lastX:0,lastY:0})},e.prototype.componentDidMount=function(){this.initCanvas()},e.prototype.componentWillReceiveProps=function(){this.initCanvas()},e.prototype.componentWillUnmount=function(){this.removeEvents()},e.prototype.render=function(){var t=this,e=this.state,n=e.times,r=e.top,s=e.left,a=e.lastX,u=e.lastY;return o.createElement("div",{ref:function(e){return t.wrapper=e}},o.createElement(i.a,{times:n,top:r,left:s,lastX:a,lastY:u}),o.createElement("canvas",{className:"picture-scrutinizer"}))},e}(o.Component);e.a=a},1511:function(t,e,n){var o=n(1512);"string"===typeof o&&(o=[[t.i,o,""]]);var r={hmr:!1,transform:void 0};n(388)(o,r);o.locals&&(t.exports=o.locals)},1512:function(t,e,n){(t.exports=n(387)(!0)).push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"index.less",sourceRoot:""}])},1513:function(t,e,n){"use strict";var o=n(0),r=(n.n(o),n(1514)),i=(n.n(r),n(1516)),s=n(21),a=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},p={fill:"rgb(89, 249, 46)",cursor:"move"},c={stroke:"rgb(211, 220, 230)"},l={fill:"rgb(56, 120, 196, .5)",cursor:"move"},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clicked=!1,e.state={pointsList:[],tempList:[],r:7,strokeWidth:1.5,oriTop:null,oriLeft:null},e.calculatePoint=function(t,n){var o=e.props,r=o.lastX,i=o.lastY,s=o.times;return{x:t*s+r,y:n*s+i}},e.calclateTimes=function(t){return t*e.props.times},e.onMouseUp=function(t){if(e.clicked&&!t){var n=e.state,o=n.tempList,r=n.pointsList;r.push(o),e.setState({tempList:[],pointsList:r})}},e.onMouseMove=function(t,n){var o=e.state.tempList;o[t]=e.resetPoint(o[t],n),e.setState({tempList:o})},e.onPolygonPointMouseMove=function(t,n,o){var r=e.state.pointsList;r[t][n]=e.resetPoint(r[t][n],o),e.setState({pointsList:r})},e.onPolygonMouseMove=function(t,n){var o=e.state.pointsList;o[t]=o[t].map(function(t){return e.resetPoint(t,n)}),e.setState({pointsList:o})},e.resetPoint=function(t,n){var o=t.x,r=t.y,i=n.x,s=n.y;return{x:o+i/e.props.times,y:r+s/e.props.times}},e.wrapperMouseDown=function(t){e.clicked=!0},e.wrapperMouseMove=function(t){e.clicked=!1},e.wrapperMouseUp=function(t){if("svg"===t.target.tagName&&e.clicked){var n=e.state.tempList;n.push(e.addPoint(t)),e.setState({tempList:n}),e.clicked=!1}},e.onPoligonLineClick=function(t,n,o){var r=e.state.pointsList;n=n===r[t].length-1?0:n+1,r[t].splice(n,0,e.addPoint(o)),e.setState({pointsList:r})},e.addPoint=function(t){var n=t.clientX,o=t.clientY,r=e.wrapper.getBoundingClientRect(),i=r.left,s=r.top,a=e.props,u=a.times,p=a.left,c=a.top;return{x:(n-(p||0)-i)/u,y:(o-(c||0)-s)/u}},e.convertPoints2String=function(t){return t.map(function(t){var n=t.x,o=t.y;return e.calculatePoint(n,o)}).map(function(t){return t.x+","+t.y}).join(" ")},e.renderTemp=function(t){var n=t.tempList,r=t.width,a=t.radius;return n.map(function(t,l){var f=t.x,d=t.y,m=l===n.length-1,h=m?n[0]:n[l+1],v=h.x,g=h.y,y=e.calculatePoint(f,d),w=y.x,M=y.y,x=e.calculatePoint(v,g),_=x.x,L=x.y;return o.createElement(o.Fragment,{key:l},m?"":o.createElement("line",u({x1:w,y1:M,x2:_,y2:L,strokeWidth:r},c)),o.createElement(i.a,{onMouseMove:s.a.handle(e.onMouseMove,l)},o.createElement("circle",u({cx:w,cy:M,r:a},p,{onMouseUp:s.a.handle(e.onMouseUp,l)}))))})},e.renderPolygon=function(t){var n=t.pointsList,r=t.width,a=t.radius;return n.map(function(t,n){return o.createElement(o.Fragment,{key:n},o.createElement(i.a,{onMouseMove:s.a.handle(e.onPolygonMouseMove,n)},o.createElement("polygon",u({points:e.convertPoints2String(t)},l))),e.renderPolygonWrapper({points:t,i:n,width:r,radius:a}))})},e.renderPolygonWrapper=function(t){var n=t.points,r=t.width,a=t.radius,l=t.i;return n.map(function(t){var n=t.x,o=t.y;return e.calculatePoint(n,o)}).map(function(t,f){var d=t.x,m=t.y,h=f===n.length-1?n[0]:n[f+1],v=h.x,g=h.y,y=e.calculatePoint(v,g),w=y.x,M=y.y;return o.createElement(o.Fragment,{key:f},o.createElement("line",u({x1:d,y1:m,x2:w,y2:M,strokeWidth:r},c,{onClick:s.a.handle(e.onPoligonLineClick,l,f)})),o.createElement(i.a,{onMouseMove:s.a.handle(e.onPolygonPointMouseMove,l,f)},o.createElement("circle",u({cx:d,cy:m,r:a},p))))})},e}return a(e,t),e.getDerivedStateFromProps=function(t,e){var n=t.left,o=t.top,r=e.oriLeft,i=e.oriTop;return null!==n&&null!==o&&null===r&&null===i?{oriLeft:n,oriTop:o}:null},e.prototype.render=function(){var t=this,e=this.state,n=e.pointsList,r=e.tempList,i=e.r,s=e.strokeWidth,a=this.calclateTimes(i),u=this.calclateTimes(s);return o.createElement("svg",{className:"svg-wrapper",ref:function(e){return t.wrapper=e},onMouseDown:this.wrapperMouseDown,onMouseMove:this.wrapperMouseMove,onMouseUp:this.wrapperMouseUp},this.renderTemp({tempList:r,width:u,radius:a}),this.renderPolygon({pointsList:n,width:u,radius:a}))},e}(o.Component);e.a=f},1514:function(t,e,n){var o=n(1515);"string"===typeof o&&(o=[[t.i,o,""]]);var r={hmr:!1,transform:void 0};n(388)(o,r);o.locals&&(t.exports=o.locals)},1515:function(t,e,n){(t.exports=n(387)(!0)).push([t.i,".svg-wrapper{position:absolute;height:100%;width:100%}","",{version:3,sources:["/Users/leonzhang/Documents/github/typescript/leon-ts-app/src/components/SVGLabelEditor/index.less"],names:[],mappings:"AAAA,aACE,kBAAmB,AACnB,YAAa,AACb,UAAY,CACb",file:"index.less",sourcesContent:[".svg-wrapper {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n}\n"],sourceRoot:""}])},1516:function(t,e,n){"use strict";var o=n(0),r=(n.n(o),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onMouseDown=function(t){var n=t.pageX,o=t.pageY;e.setState({dragging:!0,x:n,y:o})},e.onMouseUp=function(){Object.assign(e.state,{dragging:!1,x:0,y:0})},e.onMouseMove=function(t){var n=t.pageX,o=t.pageY,r=e.state,i=r.dragging,s=r.x,a=r.y;i&&(e.props.onMouseMove({x:n-s,y:o-a}),Object.assign(e.state,{x:n,y:o}))},e}return r(e,t),e.prototype.componentDidMount=function(){this.setState({dragging:!1,x:0,y:0})},e.prototype.render=function(){var t=this.onMouseDown,e=this.onMouseMove,n=this.onMouseUp;return window.addEventListener("mouseup",n),window.addEventListener("mousemove",e),o.cloneElement(this.props.children,{onMouseDown:t})},e}(o.Component);e.a=i},1517:function(t,e,n){t.exports=n.p+"static/media/justice_league.a324bd16.jpg"},404:function(t,e,n){var o=n(689);"string"===typeof o&&(o=[[t.i,o,""]]);var r={hmr:!1,transform:void 0};n(388)(o,r);o.locals&&(t.exports=o.locals)},66:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=(n.n(o),n(21)),i=n(404),s=(n.n(i),n(1510)),a=n(1517),u=n.n(a),p=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.render=function(){var t=this.props,e=t.height,n=t.width;return o.createElement("div",{className:"widget-wrapper"},o.createElement(s.a,{wrapperHeight:e,wrapperWidth:n,src:u.a}))},e}(o.Component);e.default=r.a.connect({component:c,mapStateToProps:function(t){return{height:t.common.contentHeight,width:t.common.contentWidth}}})},689:function(t,e,n){(t.exports=n(387)(!0)).push([t.i,".widget-wrapper{width:100%;height:100%}","",{version:3,sources:["/Users/leonzhang/Documents/github/typescript/leon-ts-app/src/pages/Widgets/index.less"],names:[],mappings:"AAAA,gBACE,WAAY,AACZ,WAAa,CACd",file:"index.less",sourcesContent:[".widget-wrapper {\n  width: 100%;\n  height: 100%;\n}\n"],sourceRoot:""}])}});
//# sourceMappingURL=9.f020f61c.chunk.js.map